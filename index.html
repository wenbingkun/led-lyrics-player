<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LED演出歌词显示器</title>
    <link rel="icon" href="data:,">
    <link rel="stylesheet" href="css/style.css">
</head>

<body class="theme-classic">
    <div id="backgroundContainer" class="background-container"></div>
    <div class="background-overlay"></div>

    <div id="songInfo" class="song-info" style="display: none;">
        <div id="displaySongTitle" class="song-title"></div>
        <div id="displaySongIndex" class="song-index" style="display: none;"></div>
        <div id="lyricProgress" class="lyric-progress" style="display: none;">
            <span id="lyricProgressText"></span>
        </div>
    </div>

    <div class="lyrics-display">
        <div id="currentLyric" class="current-lyric">请上传LRC歌词文件</div>
        <div id="nextLyric" class="next-lyric">开始你的演出</div>
    </div>

    <div id="statusIndicator" class="status-indicator"></div>

    <div id="notificationContainer" class="notification-container"></div>

    <!-- 触发区域 -->
    <div class="trigger-zone" title="把鼠标移到这里显示控制台"></div>

    <div class="control-panel">
        <div class="panel-header">
            <div class="panel-title">LED 歌词控制台</div>
            <button id="toggleResources" class="icon-button" title="资源管理">📂</button>
        </div>
        
        <!-- 资源反馈提示 (新增) -->
        <div id="loadedResourceHint" class="resource-hint"></div>

        <!-- 可折叠的资源管理区 -->
        <div id="resourcesPanel" class="resources-panel" style="display: none;">
            <div class="file-upload-group">
                <label class="upload-label">歌词文件 (.lrc/.txt)</label>
                <div style="display: flex; gap: 10px;">
                    <input type="file" id="lrcFile" class="file-input" accept=".lrc,.txt" multiple>
                    <button type="button" id="lrcFolderBtn" class="folder-button" title="选择歌词文件夹">📂</button>
                </div>
                <div id="lrcPathDisplay" class="path-display"></div>
                <input type="file" id="lrcFolder" style="display: none;" webkitdirectory directory multiple>
                <div id="lrcFolderHint" class="compatibility-hint" style="display: none;"></div>
            </div>

            <div class="file-upload-group">
                <label class="upload-label">音频文件 (mp3/wav/flac...)</label>
                <div style="display: flex; gap: 10px;">
                    <input type="file" id="audioFile" class="file-input" accept="audio/*,video/*" multiple>
                    <button type="button" id="audioFolderBtn" class="folder-button" title="选择音频文件夹">📂</button>
                </div>
                <div id="audioPathDisplay" class="path-display"></div>
                <input type="file" id="audioFolder" style="display: none;" webkitdirectory directory multiple>
                <div id="audioFolderHint" class="compatibility-hint" style="display: none;"></div>
            </div>

            <div class="file-upload-group">
                <label class="upload-label">背景图片</label>
                <input type="file" id="backgroundFile" class="file-input" accept="image/*">
                <div id="bgPathDisplay" class="path-display"></div>
            </div>
        </div>

        <div id="currentSongInfo" class="current-song-info" style="display: none;">
            <div id="currentSongName" class="current-song-name"></div>
            <div id="currentSongStatus" class="current-song-status"></div>
            <div id="offsetDisplay" style="font-size: 12px; color: #aaa; margin-top: 4px;"></div>
        </div>

        <!-- 核心播放控制区 (Hero Section) -->
        <div class="playback-hero">
            <!-- 进度条上移 -->
            <div class="time-row">
                <span id="currentTime" class="time-info">0:00</span>
                <div id="progressContainer" class="progress-container">
                    <div id="progressBar" class="progress-bar"></div>
                </div>
                <span id="totalTime" class="time-info">0:00</span>
            </div>
            
            <!-- 播放按钮居中放大 -->
            <div class="controls-main">
                <button id="playButton" class="play-button" disabled title="播放/暂停 (空格)">▶</button>
            </div>
        </div>

        <!-- 播放列表区域 -->
        <div class="playlist-section">
            <div class="playlist-toolbar">
                <div class="search-box">
                    <input type="text" id="lyricsSearch" class="search-input" placeholder="搜索... (F)">
                    <button id="searchButton" class="icon-button small" title="搜索">🔍</button>
                    <button id="clearSearch" class="icon-button small" title="清除">✕</button>
                </div>
                <div class="playlist-actions">
                    <button id="sortPlaylist" class="icon-button" title="排序">AZ</button>
                    <button id="importPlaylist" class="icon-button" title="导入">📥</button>
                    <input type="file" id="playlistFile" style="display: none;" accept=".json">
                    <button id="exportPlaylist" class="icon-button" title="导出">📤</button>
                    <button id="clearPlaylist" class="icon-button danger" title="清空">🗑️</button>
                </div>
            </div>
            
            <div id="searchResults" class="search-results" style="display: none;"></div>

            <div class="playlist-header">
                <span id="playlistCount" class="playlist-count">0 首歌曲</span>
                <!-- 播放模式放在列表头 -->
                <div class="play-mode-toggle">
                    <button class="play-mode-button active" data-mode="loop" title="列表循环">🔁</button>
                    <button class="play-mode-button" data-mode="list" title="列表播放">📋</button>
                    <button class="play-mode-button" data-mode="single" title="单曲循环">🔂</button>
                    <button class="play-mode-button" data-mode="random" title="随机播放">🔀</button>
                </div>
            </div>

            <div id="playlist" class="playlist">
                <div class="empty-playlist">还没有歌曲，请上传LRC文件</div>
            </div>
        </div>

        <!-- 同步微调 (Contextual) -->
        <div id="syncControls" class="sync-controls-panel" style="display: none;">
            <span class="control-label">同步微调</span>
            <div class="segmented-control">
                <button class="sync-button" data-offset="-0.5">◄</button>
                <button class="sync-button" data-offset="-0.1">-0.1s</button>
                <button id="resetOffset" class="sync-button reset">0</button>
                <button class="sync-button" data-offset="0.1">+0.1s</button>
                <button class="sync-button" data-offset="0.5">►</button>
            </div>
        </div>

        <!-- 外观设置 (底部) -->
        <div class="settings-section">
            <div class="setting-row">
                <span class="setting-label">速度</span>
                <div class="segmented-control">
                    <button class="speed-button" data-speed="0.5">0.5</button>
                    <button class="speed-button active" data-speed="1.0">1.0</button>
                    <button class="speed-button" data-speed="1.5">1.5</button>
                    <button class="speed-button" data-speed="2.0">2.0</button>
                </div>
            </div>
            <div class="setting-row">
                <span class="setting-label">字号</span>
                <div class="segmented-control">
                    <button class="font-size-button" data-font-size="0.8">S</button>
                    <button class="font-size-button active" data-font-size="1.3">M</button>
                    <button class="font-size-button" data-font-size="1.8">L</button>
                    <button class="font-size-button" data-font-size="2.4">XL</button>
                </div>
            </div>
            <div class="setting-row">
                <span class="setting-label">主题</span>
                <div class="segmented-control theme-selector">
                    <button class="theme-button active" data-theme="classic" title="经典">⚪</button>
                    <button class="theme-button" data-theme="gold" title="流金">🟡</button>
                    <button class="theme-button" data-theme="blue" title="赛博">🔵</button>
                    <button class="theme-button" data-theme="rainbow" title="霓虹">🌈</button>
                </div>
            </div>
        </div>

        <div class="footer-hint">
            双击播放 • 空格暂停 • 拖拽排序
        </div>
    </div>

    <div id="dragOverlay" class="drag-overlay">
        <div class="drag-hint">
            <div>📂</div>
            <div>释放文件以添加</div>
        </div>
    </div>

    <!-- 模块化引入JS -->
    <script type="module" src="js/app.js"></script>
</body>

</html>
